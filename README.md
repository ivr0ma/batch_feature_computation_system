# Batch Feature Computation System

–°–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–µ—Ñ–æ–ª—Ç–∞ –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º XGBoost Classifier –Ω–∞ PySpark.

## –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä XGBoost –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–µ—Ñ–æ–ª—Ç–∞ –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö Lending Club. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –Ω–∞ PySpark –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV
- –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –∏ —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (MinMaxScaler)
- –û–±—É—á–µ–Ω–∏–µ XGBoost Classifier –Ω–∞ PySpark
- –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ (ROC-AUC, Accuracy)
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Python**: 3.8+
- **Java**: JDK 17 –∏–ª–∏ –≤—ã—à–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è PySpark 3.5+)
- **–û–°**: Linux, macOS, Windows (WSL)

### Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∫–∞–∑–∞–Ω—ã –≤ `requirements.txt`:

- `pyspark>=3.5.0` - Apache Spark –¥–ª—è Python
- `xgboost>=2.0.0` - XGBoost —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Spark
- `scikit-learn>=1.0.0` - –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è XGBoost
- `pyarrow>=15.0.0` - –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É Spark –∏ XGBoost
- `numpy>=1.24.0`
- `pandas>=2.0.0`
- `jupyterlab>=4.0.0` - –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ—É—Ç–±—É–∫–∞–º–∏

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Java JDK 17+

#### Ubuntu/Debian:
```bash
sudo apt-get update
sudo apt-get install openjdk-17-jdk
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:
```bash
java -version  # –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –≤–µ—Ä—Å–∏—é 17 –∏–ª–∏ –≤—ã—à–µ
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64
export PATH=$JAVA_HOME/bin:$PATH

# –î–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ ~/.bashrc:
echo 'export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64' >> ~/.bashrc
echo 'export PATH=$JAVA_HOME/bin:$PATH' >> ~/.bashrc
source ~/.bashrc
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
python -m venv venv
source venv/bin/activate  # Linux/macOS
# –∏–ª–∏
venv\Scripts\activate  # Windows
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ XGBoost Classifier –Ω–∞ PySpark

–ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º):

```bash
python xgboost_pyspark.py --data-path data/lending_club_loan_two.csv
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

```bash
python xgboost_pyspark.py \
    --data-path data/lending_club_loan_two.csv \
    --target-col loan_status \
    --train-split 0.67 \
    --model-path models/xgboost_model \
    --num-workers 2 \
    --max-depth 6 \
    --n-estimators 100 \
    --learning-rate 0.3 \
    --random-state 42 \
    --show-samples
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

- `--data-path` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –ü—É—Ç—å –∫ CSV —Ñ–∞–π–ª—É —Å –¥–∞–Ω–Ω—ã–º–∏
- `--target-col` - –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –∫–æ–ª–æ–Ω–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `loan_status`)
- `--train-split` - –î–æ–ª—è –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `0.67`)
- `--model-path` - –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `--num-workers` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ worker –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ XGBoost (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `2`)
- `--use-gpu` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GPU –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (—Ñ–ª–∞–≥)
- `--max-depth` - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤—å–µ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `6`)
- `--n-estimators` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ä–µ–≤—å–µ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `100`)
- `--learning-rate` - –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `0.3`)
- `--random-state` - Seed –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `42`)
- `--show-samples` - –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π (—Ñ–ª–∞–≥)

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–¥–µ–ª—å:
```bash
python xgboost_pyspark.py --data-path data/lending_club_loan_two.csv --model-path models/xgboost_model
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GPU –∏ –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã:
```bash
python xgboost_pyspark.py --data-path data/lending_club_loan_two.csv --use-gpu --show-samples
```

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏:
```bash
python xgboost_pyspark.py \
    --data-path data/lending_club_loan_two.csv \
    --max-depth 8 \
    --n-estimators 200 \
    --learning-rate 0.1
```

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏

–î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `--model-path`:

```bash
python xgboost_pyspark.py --data-path data/lending_club_loan_two.csv --model-path models/xgboost_model
```

–ú–æ–¥–µ–ª—å –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π:

```python
from pyspark.sql import SparkSession
from xgboost.spark import SparkXGBClassifierModel

# –°–æ–∑–¥–∞–Ω–∏–µ Spark —Å–µ—Å—Å–∏–∏
spark = SparkSession.builder.appName("Load_XGBoost_Model").getOrCreate()

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏
loaded_model = SparkXGBClassifierModel.load("models/xgboost_model")

# –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
# (–Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç—É –∂–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É, —á—Ç–æ –∏ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏)
from xgboost_pyspark import load_data, remove_outliers, preprocess_data

test_data = load_data(spark, "data/test_data.csv")
test_data = remove_outliers(test_data)
test_data, _, _ = preprocess_data(test_data, target_col='loan_status')

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
predictions = loaded_model.transform(test_data)
predictions.select("label", "prediction", "probability").show(10)

spark.stop()
```

### –†–∞–±–æ—Ç–∞ —Å Jupyter Notebook

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º –Ω–æ—É—Ç–±—É–∫–æ–º:

```bash
jupyter lab
```

–û—Ç–∫—Ä–æ–π—Ç–µ `lending-club-loan-defaulters-prediction.ipynb` –≤ Jupyter Lab.

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
batch_feature_computation_system/
‚îú‚îÄ‚îÄ data/                                    # –î–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ lending_club_loan_two.csv           # –ë–∞–∑–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ accepted_2007_to_2018Q4.csv        # –ü–æ–ª–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç (–ø—Ä–∏–Ω—è—Ç—ã–µ –∑–∞—è–≤–∫–∏)
‚îÇ   ‚îî‚îÄ‚îÄ rejected_2007_to_2018Q4.csv        # –ü–æ–ª–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç (–æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏)
‚îú‚îÄ‚îÄ xgboost_pyspark.py                       # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è XGBoost –Ω–∞ PySpark
‚îú‚îÄ‚îÄ lending-club-loan-defaulters-prediction.ipynb  # –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –Ω–æ—É—Ç–±—É–∫
‚îú‚îÄ‚îÄ requirements.txt                         # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ README.md                                # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ venv/                                    # –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏

–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (—Å–º. —Ä–∞–∑–¥–µ–ª "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ"). –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã XGBoost:

- `--num-workers` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ worker –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 2)
- `--max-depth` - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤—å–µ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 6)
- `--n-estimators` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ä–µ–≤—å–µ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 100)
- `--learning-rate` - –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.3)
- `--use-gpu` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GPU –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞–º—è—Ç–∏ Spark

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–º—è—Ç–∏ Spark –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `create_spark_session()` –≤ —Ñ–∞–π–ª–µ `xgboost_pyspark.py`:

```python
spark = SparkSession.builder \
    .config("spark.driver.memory", "4g") \      # –ü–∞–º—è—Ç—å –¥—Ä–∞–π–≤–µ—Ä–∞
    .config("spark.executor.memory", "4g") \    # –ü–∞–º—è—Ç—å executor
    .config("spark.driver.maxResultSize", "2g")  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    .getOrCreate()
```

–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `create_spark_session()` –∏–ª–∏ –ø–µ—Ä–µ–¥–∞–π—Ç–µ –∏—Ö –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–µ—Å—Å–∏–∏.

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:

- **Train ROC-AUC**: –ú–µ—Ç—Ä–∏–∫–∞ –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ
- **Test ROC-AUC**: –ú–µ—Ç—Ä–∏–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
- **Train Accuracy**: –¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ
- **Test Accuracy**: –¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
- **–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π**: –ü–µ—Ä–≤—ã–µ 10 —Å—Ç—Ä–æ–∫ —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω —Ñ–ª–∞–≥ `--show-samples`)

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```
2025-01-27 10:30:15 - __main__ - INFO - Loading data from data/lending_club_loan_two.csv
2025-01-27 10:30:20 - __main__ - INFO - Data loaded: 396030 rows, 27 columns
2025-01-27 10:30:25 - __main__ - INFO - Outliers removed: 396030 -> 385421 rows
2025-01-27 10:30:30 - __main__ - INFO - Found 15 numeric and 5 categorical columns
2025-01-27 10:30:35 - __main__ - INFO - Training XGBoost model...
2025-01-27 10:35:40 - __main__ - INFO - Training completed
2025-01-27 10:35:45 - __main__ - INFO - Model Evaluation Results:
2025-01-27 10:35:45 - __main__ - INFO -   Train ROC-AUC: 0.7939
2025-01-27 10:35:45 - __main__ - INFO -   Test ROC-AUC: 0.7282
2025-01-27 10:35:45 - __main__ - INFO -   Train Accuracy: 0.8225
2025-01-27 10:35:45 - __main__ - INFO -   Test Accuracy: 0.8060
2025-01-27 10:35:50 - __main__ - INFO - Pipeline completed successfully
```

## üîç –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

1. **–£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤**: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ—Ä–æ–≥–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º:
   - `annual_inc <= 250000`
   - `dti <= 50`
   - `open_acc <= 40`
   - `total_acc <= 80`
   - `revol_util <= 120`
   - `revol_bal <= 250000`

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤**: –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

3. **–ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `StringIndexer` –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ —á–∏—Å–ª–æ–≤—ã–µ –∏–Ω–¥–µ–∫—Å—ã

4. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–µ—Ä—Å–∏—é Java –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö: 67% train / 33% test –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `--train-split`)
- –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- –ú–æ–¥–µ–ª—å –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (—Ñ–ª–∞–≥ `--model-path`)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–æ–¥—É–ª—å `logging`
- BrokenPipeError –≤ –∫–æ–Ω—Ü–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è - –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ Spark —Å–µ—Å—Å–∏–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [PySpark Documentation](https://spark.apache.org/docs/latest/api/python/)
- [XGBoost Spark Integration](https://xgboost.readthedocs.io/en/latest/tutorials/spark_estimator.html)
- [Apache Spark Documentation](https://spark.apache.org/docs/latest/)
